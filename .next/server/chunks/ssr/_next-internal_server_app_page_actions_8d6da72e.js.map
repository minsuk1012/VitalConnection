{"version":3,"sources":["../../../../app/actions.ts"],"sourcesContent":["'use server'\n\nimport { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\nconst slackWebhookUrl = process.env.SLACK_WEBHOOK_URL\n\nif (!supabaseUrl || !supabaseKey) {\n  console.error(\"Missing Supabase environment variables\")\n}\n\nconst supabase = createClient(supabaseUrl!, supabaseKey!)\n\nexport async function submitInquiry(formData: {\n  hospital: string\n  name: string\n  phone: string\n  email: string\n}) {\n  console.log(\"Submitting inquiry:\", formData)\n  \n  // 1. Save to Supabase\n  const { error: dbError } = await supabase\n    .from('consultations')\n    .insert([\n      {\n        hospital_name: formData.hospital,\n        contact_name: formData.name,\n        phone: formData.phone,\n        email: formData.email,\n      },\n    ])\n\n  if (dbError) {\n    console.error(\"Supabase Error:\", dbError)\n    throw new Error(\"Failed to save inquiry\")\n  }\n\n  // 2. Send to Slack\n  if (slackWebhookUrl) {\n    try {\n      const slackMessage = {\n        text: `üöÄ *ÏÉàÎ°úÏö¥ ÏûÖÏ†ê Î¨∏ÏùòÍ∞Ä ÎèÑÏ∞©ÌñàÏäµÎãàÎã§!*`,\n        blocks: [\n          {\n            type: \"header\",\n            text: {\n              type: \"plain_text\",\n              text: \"üöÄ ÏÉàÎ°úÏö¥ ÏûÖÏ†ê Î¨∏Ïùò\",\n              emoji: true\n            }\n          },\n          {\n            type: \"section\",\n            fields: [\n              {\n                type: \"mrkdwn\",\n                text: `*Î≥ëÏõêÎ™Ö:*\\n${formData.hospital}`\n              },\n              {\n                type: \"mrkdwn\",\n                text: `*Îã¥ÎãπÏûê:*\\n${formData.name}`\n              },\n              {\n                type: \"mrkdwn\",\n                text: `*Ïó∞ÎùΩÏ≤ò:*\\n${formData.phone}`\n              },\n              {\n                type: \"mrkdwn\",\n                text: `*Ïù¥Î©îÏùº:*\\n${formData.email}`\n              }\n            ]\n          }\n        ]\n      }\n\n      const response = await fetch(slackWebhookUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(slackMessage),\n      })\n\n      if (!response.ok) {\n        console.error(\"Slack Webhook Error:\", await response.text())\n      }\n    } catch (slackError) {\n      console.error(\"Failed to send Slack notification:\", slackError)\n      // We don't throw here to avoid failing the whole request if just Slack fails\n    }\n  }\n\n  return { success: true }\n}\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,oBAIA,IAAM,EAAkB,QAAQ,GAAG,CAAC,iBAAiB,CAM/C,EAAW,CAAA,EAAA,EAAA,YAAY,AAAZ,EAAa,AARxB,aAQsC,8BAPtC,kDASC,eAAe,EAAc,CAKnC,EACC,QAAQ,GAAG,CAAC,sBAAuB,GAGnC,GAAM,CAAE,MAAO,CAAO,CAAE,CAAG,MAAM,EAC9B,IAAI,CAAC,iBACL,MAAM,CAAC,CACN,CACE,cAAe,EAAS,QAAQ,CAChC,aAAc,EAAS,IAAI,CAC3B,MAAO,EAAS,KAAK,CACrB,MAAO,EAAS,KAAK,AACvB,EACD,EAEH,GAAI,EAEF,MADA,CADW,OACH,KAAK,CAAC,kBAAmB,GAC3B,AAAI,MAAM,0BAIlB,GAAI,EACF,GAAI,CACF,IAAM,EAAe,CACnB,IAHe,CAGT,CAAC,uBAAuB,CAAC,CAC/B,OAAQ,CACN,CACE,KAAM,SACN,KAAM,CACJ,KAAM,aACN,KAAM,eACN,OAAO,CACT,CACF,EACA,CACE,KAAM,UACN,OAAQ,CACN,CACE,KAAM,SACN,KAAM,CAAC;AAAQ,EAAE,EAAS,QAAQ,CAAA,CAAE,AACtC,EACA,CACE,KAAM,SACN,KAAM,CAAC;AAAQ,EAAE,EAAS,IAAI,CAAA,CAAE,AAClC,EACA,CACE,KAAM,SACN,KAAM,CAAC;AAAQ,EAAE,EAAS,KAAK,CAAA,CAAE,AACnC,EACA,CACE,KAAM,SACN,KAAM,CAAC;AAAQ,EAAE,EAAS,KAAK,CAAA,CAAE,AACnC,EACD,AACH,EACD,AACH,EAEM,EAAW,MAAM,MAAM,EAAiB,CAC5C,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,EACvB,EAEI,CAAC,EAAS,EAAE,EAAE,AAChB,QAAQ,KAAK,CAAC,uBAAwB,MAAM,EAAS,IAAI,GAE7D,CAAE,MAAO,EAAY,CACnB,QAAQ,KAAK,CAAC,qCAAsC,EAEtD,CAGF,MAAO,CAAE,SAAS,CAAK,CACzB,iCA/EsB,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA"}